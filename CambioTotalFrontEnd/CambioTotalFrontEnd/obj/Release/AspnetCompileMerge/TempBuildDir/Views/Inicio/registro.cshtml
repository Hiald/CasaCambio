
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <title>Casa de cambio | Registro</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="A fully featured admin theme which can be used to build CRM, CMS, etc." name="description" />
    <meta content="Crivant" name="author" />
    <!-- App favicon -->
    @*<link rel="shortcut icon" href="assets/images/favicon.ico">*@
    <link rel="shortcut icon" href="~/assets/tucambio.png">

    <!-- App css -->
    <link href="~/assets/css/vendor/jquery-jvectormap-1.2.2.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/css/app.min.css" rel="stylesheet" type="text/css" id="light-style" />
    <link href="~/assets/css/app-dark.min.css" rel="stylesheet" type="text/css" id="dark-style" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/css-loader/3.3.3/css-loader.css" rel="stylesheet" />

    <script>
         var RutaPrincipal = "@Url.Content("~")";
    </script>
    <style>
        .custom-control-label::before {
            position: absolute;
            top: .175rem;
            left: -1.5rem;
            display: block;
            width: 1rem;
            height: 1rem;
            pointer-events: none;
            content: "";
            background-color: #fff;
            border: #151714 solid 2px;
        }
        
    </style>
</head>

<body class="authentication-bg pb-0" data-layout-config='{"darkMode":false}'>
    <div id="divcarga" class="loader loader-default" data-text="Cargando... por favor espere" blink></div>

    <div class="account-pages mb-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header pt-2 pb-2 text-center bg-success">
                            <a href="index.html">
                                @*<span><img src="assets/images/logo.png" alt="" height="18"></span>*@
                            </a>
                        </div>

                        <div class="card-body p-3">
                            <div class="text-center w-75 m-auto">
                                <h4 class="text-dark-50 text-center mt-0 font-weight-bold">Regístrate</h4>
                                <p class="text-muted m2-4">Crea tu cuenta para poder continuar cambiando y ahorrando</p>
                            </div>

                            <form action="#" id="frm1">
                                <h6 class="font-15 mt-3">¿Qué tipo de cuenta deseas crear?</h6>
                                <div class="mt-2">
                                    <div class="custom-control custom-radio custom-control-inline">
                                        <input type="radio" id="customRadio3" checked value="1" name="rbt" class="custom-control-input">
                                        <label class="custom-control-label" for="customRadio3">Para uso personal</label>
                                    </div>
                                    <div class="custom-control custom-radio custom-control-inline">
                                        <input type="radio" id="customRadio4" value="2" name="rbt" class="custom-control-input">
                                        <label class="custom-control-label" for="customRadio4">Para empresas</label>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="txnombre">Nombres*</label>
                                            <input class="form-control" maxlength="40" type="text" id="txnombre" placeholder="Ingresa tus nombres">
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="txapellido">Apellidos*</label>
                                            <input class="form-control" maxlength="40" type="text" id="txapellido" placeholder="Ingresa tus apellidos">
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="slctipodocumento">Tipo de documento</label>
                                        <select class="custom-select mb-3" id="slctipodocumento">
                                            <option value="1">DNI</option>
                                            <option value="2">Carnet de extranjería</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group" id="divpersona">
                                            <label for="txdocumento">Número del documento*</label>
                                            <input class="form-control" maxlength="13" type="text" id="txdocumento" placeholder="Ingresa el número del documento">
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 form-group" id="divempresa">
                                        <label for="txruc">RUC</label>
                                        <input class="form-control" maxlength="14" type="text" id="txruc" placeholder="Ingresa el número de RUC">
                                    </div>
                                    <div class="col-md-6 form-group" id="divempresa2">
                                        <label for="txrazonsocial">Razón Social</label>
                                        <input class="form-control" maxlength="75" type="text" id="txrazonsocial" placeholder="Ingresa la razón social">
                                    </div>
                                </div>
                                 
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="txcorreo">Correo*</label>
                                            <input class="form-control" maxlength="100" type="email" id="txcorreo" placeholder="Ingresa tu correo electrónico">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="txcelular">Celular</label>
                                            <input class="form-control" maxlength="9" type="text" id="txcelular" placeholder="Ingresa el número de celular">
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="password">Contraseña*</label>
                                            <div class="input-group input-group-merge">
                                                <input type="password" id="password" maxlength="20" class="form-control" placeholder="Ingresa tu contraseña">
                                                <div class="input-group-append" data-password="false">
                                                    <div class="input-group-text">
                                                        <span class="password-eye"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="passwordrep">Repite Contraseña*</label>
                                            <div class="input-group input-group-merge">
                                                <input type="password" id="passwordrep" maxlength="20" class="form-control" placeholder="Repite tu contraseña">
                                                <div class="input-group-append" data-password="false">
                                                    <div class="input-group-text">
                                                        <span class="password-eye"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" class="custom-control-input" id="checkbox-signup">
                                        <label class="custom-control-label" for="checkbox-signup">Acepto los&nbsp;<a href="@Url.Action("terminosycondiciones","inicio")" class="text-muted" target="_blank">Términos y condiciones</a></label>
                                    </div>
                                </div>

                                <div class="form-group mb-0 text-center">
                                    <button type="button" id="btnsiguiente" class="btn btn-primary">
                                        Siguiente
                                    </button>
                                </div>

                            </form>
                        </div>

                    </div>
                    <!-- end card -->

                    <div class="row mt-3">
                        <div class="col-12 text-center">
                            <p class="text-success">¿Tienes cuenta? <a href="@Url.Action("inicio","Inicio")" class="text-success ml-1"><b>Inicia sesión</b></a></p>
                        </div> <!-- end col-->
                    </div>
                    <!-- end row -->

                </div> <!-- end col -->
            </div>
            <!-- end row -->
        </div>
        <!-- end container -->
    </div>
    <!-- end page -->

    <div class="modal fade" id="RegModal" tabindex="-1" role="dialog" aria-labelledby="RegModal" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Estás a un paso de terminar</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="card">
                        <strong>PEP:&nbsp;</strong><p>Son personas naturales, nacionales o extranjeras, que cumplen o que en los últimos cinco (5) años hayan cumplido funciones públicas destacas</p>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <label>¿Es usted una persona expuesta Políticamente&nbsp;<strong>PEP</strong>?</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="tp1" value="1">
                                <label class="form-check-label" for="exampleRadios1">
                                    Sí
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="tp1" value="2">
                                <label class="form-check-label" for="exampleRadios2">
                                    No
                                </label>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <label>¿Tienes vínculo familiar consanguíneo con una persona&nbsp;<strong>PEP</strong>?</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="tp2" value="1">
                                <label class="form-check-label" for="exampleRadios1">
                                    Sí
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="tp2" value="2">
                                <label class="form-check-label" for="exampleRadios2">
                                    No
                                </label>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <label>¿Tienes vínculo de afinidad con una persona&nbsp;<strong>PEP</strong>?</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="tp3" value="1">
                                <label class="form-check-label" for="exampleRadios1">
                                    Sí
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="tp3" value="2">
                                <label class="form-check-label" for="exampleRadios2">
                                    No
                                </label>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <label>¿Eres cónyuge o conviviente de una persona&nbsp;<strong>PEP</strong>?</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="tp4" value="1">
                                <label class="form-check-label" for="exampleRadios1">
                                    Sí
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="tp4" value="2">
                                <label class="form-check-label" for="exampleRadios2">
                                    No
                                </label>
                            </div>
                        </div>

                        <div class="col-md-12">
                            <hr />
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="inlineCheckbox122" value="option1">
                                <label class="form-check-label" for="inlineCheckbox1">Declaro bajo juramento que la información brindada es verdadera y exacta.</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-info" id="btncrearcuenta"> Crear cuenta </button>
                </div>
            </div>
        </div>
    </div>

    <script src="~/assets/js/vendor.min.js"></script>
    <script src="~/assets/js/app.min.js"></script>
    <script src="~/assets/js/moment.js"></script>

    <script>
        function validarNumero(numero) {
            var regex = /^-?\d*$/;
            return regex.test(numero);
        }

        $('#btnsiguiente').click(function () {
            $('#divcarga').addClass("is-active");
            var itipocuenta = $('input[name="rbt"]:checked').val();
            var snombre = $('#txnombre').val();
            var sapellido = $('#txapellido').val();
            var itipodocumento = $('#slctipodocumento option:selected').val();
            var sdocumento = $('#txdocumento').val();
            var sruc = $('#txruc').val();
            var srazonsocial = $('#txrazonsocial').val();
            var scorreo = $('#txcorreo').val();
            var sclave = $('#password').val();
            var repsclave = $('#passwordrep').val();
            var sfecharegistro = moment().format("YYYY-MM-DD");
            var shora = moment().format("hh:mm:ss");
            var scelular = $('#txcelular').val();
            //1 personal, 2 empresa

            if (itipocuenta == 1) {
                if (snombre == "" || sapellido == "" || sdocumento == "" || scorreo == "") {
                    alert("Falta completar campos");
                    $('#divcarga').removeClass("is-active");
                    return;
                }
            } else {
                if (snombre == "" || sapellido == "" || sdocumento == "" || scorreo == "" || sruc == "" || srazonsocial == "") {
                    alert("Falta completar campos");
                    $('#divcarga').removeClass("is-active");
                    return;
                }
            }

            if (scelular.length != 0) {
                if (!validarNumero(scelular) || scelular.length < 9) {
                    alert("Ingrese un celular válido");
                    $('#divcarga').removeClass("is-active");
                    return;
                }
            }


            if (sdocumento.length < 8) {
                alert("El número de documento debe contener 8 dígitos");
                $('#divcarga').removeClass("is-active");
                return;
            }

            if (ivalorempresa == 1) {
                if (sruc.length < 11) {
                    alert("El ruc debe tener como mínimo 11 dígitos");
                    $('#divcarga').removeClass("is-active");
                    return;
                }
                if (srazonsocial == "") {
                    alert("Completar el campo Razón social");
                    $('#divcarga').removeClass("is-active");
                    return;
                }
            }

            if (sclave.length <= 6) {
                alert("La contraseña debe ser mayor a 6 dígitos");
                $('#divcarga').removeClass("is-active");
                return;
            }

            if (sclave != repsclave) {
                alert("¡Ups! Las contraseñas no coinciden.");
                $('#divcarga').removeClass("is-active");
                return;
            }

            if ($("#checkbox-signup").prop('checked') == false) {
                alert("Por favor, acepta los términos y condiciones");
                $('#divcarga').removeClass("is-active");
                return;
            }

            $("#RegModal").modal("show");
            $('#divcarga').removeClass("is-active");
        });

        $('#frm1').submit(false);
        function NotificacionInfoDerecha(mensaje) {
            $.NotificationApp.send("Aviso!", mensaje, "top-right", "rgba(0,0,0,0.2)", "info")
        }

        function NotificacionAvisoIzquierda(mensaje) {
            $.NotificationApp.send("AVISO!", mensaje, "top-left", "rgba(0,0,0,0.2)", "warning")
        }

        function NotificacionAvisoIzquierdaAbajo(mensaje) {
            $.NotificationApp.send("AVISO!", mensaje, "bottom-left", "rgba(0,0,0,0.2)", "warning")
        }

        function NotificacionErrorIzquierda(mensaje) {
            $.NotificationApp.send("ERROR!", mensaje, "top-left", "rgba(0,0,0,0.2)", "error")
        }

        function NotificacionSuccessIzquierda(mensaje) {
            $.NotificationApp.send("DATOS CORRECTOS!", mensaje, "top-left", "rgba(0,0,0,0.2)", "success")
        }

        $('#divempresa').hide();
        $('#divempresa2').hide();
        var ivalorempresa = 0;
        $('input[type=radio][name=rbt]').change(function () {
            if (this.value == 1) {
                $('#divempresa').hide();
                $('#divempresa2').hide();
                ivalorempresa = 0;
            }
            else if (this.value == 2) {
                $('#divempresa').show();
                $('#divempresa2').show();
                ivalorempresa = 1;
            }
        });

        var txtrucver = document.getElementById('txruc');
        txtrucver.addEventListener('keyup', myFunc);
        function myFunc(e) {
            var val = this.value;
            var re = /^([0-9]|[0-9]+)$/g;
            var re1 = /^([0-9]|[0-9]+)/g;
            if (re.test(val)) {
                //do something here

            } else {
                val = re1.exec(val);
                if (val) {
                    this.value = val[0];
                } else {
                    this.value = "";
                }
            }
        }

        $('#btncrearcuenta').click(function () {

            var itipocuenta = $('input[name="rbt"]:checked').val();
            var snombre = $('#txnombre').val();
            var sapellido = $('#txapellido').val();
            var itipodocumento = $('#slctipodocumento option:selected').val();
            var sdocumento = $('#txdocumento').val();
            var sruc = $('#txruc').val();
            var srazonsocial = $('#txrazonsocial').val();
            var scorreo = $('#txcorreo').val();
            var sclave = $('#password').val();
            var repsclave = $('#passwordrep').val();
            var sfecharegistro = moment().format("YYYY-MM-DD");
            var shora = moment().format("hh:mm:ss");
            var scelularReg = $('#txcelular').val();
            //1 personal, 2 empresa

            var Parampep1 = $('input[name="tp1"]:checked').val();
            var Parampep2 = $('input[name="tp2"]:checked').val();
            var Parampep3 = $('input[name="tp3"]:checked').val();
            var Parampep4 = $('input[name="tp4"]:checked').val();

            if ($('input[name=tp1]:checked').val() == undefined) {
                alert("Por favor, selecciona algunas opciones PEP faltantes");
                return;
            }

            if ($('input[name=tp2]:checked').val() == undefined) {
                alert("Por favor, selecciona algunas opciones PEP faltantes");
                return;
            }

            if ($('input[name=tp3]:checked').val() == undefined) {
                alert("Por favor, selecciona algunas opciones PEP faltantes");
                return;
            }

            if ($('input[name=tp4]:checked').val() == undefined) {
                alert("Por favor, selecciona algunas opciones PEP faltantes");
                return;
            }

            if ($("#inlineCheckbox122").prop('checked') == false) {
                alert("Por favor, selecciona la opción de juramento de información");
                return;
            }

            $('#divcarga').addClass("is-active");
            $.ajax({
                type: "POST",
                url: RutaPrincipal + 'Inicio/CrearUsuario',
                data: {
                    "wnombres": snombre,
                    "wapellidos": sapellido,
                    "wtipodocumento": itipodocumento,
                    "wdocumento": sdocumento,
                    "wfecharegistro": sfecharegistro,
                    "whoraregistro": shora,
                    "wtipousuario": itipocuenta,
                    "wcorreo": scorreo,
                    "wclave": sclave,
                    "wtoken": "",
                    "wruc": sruc,
                    "wrazonsocial": srazonsocial,
                    "wpep1": Parampep1,
                    "wpep2": Parampep2,
                    "wpep3": Parampep3,
                    "wpep4": Parampep4,
                    "wcelular": scelularReg
                },
                async: false,
                success: function (msg) {
                    if (msg.iResultado == -3) {
                        $('#divcarga').removeClass("is-active");
                        NotificacionErrorIzquierda("USUARIO O CLAVE INCORRECTO");
                        return;
                    } else {
                        window.location.href = RutaPrincipal + "Inicio/Principal";
                    }
                },
                error: function (msg) {
                    $('#divcarga').removeClass("is-active");
                    //location.reload();
                },
                complete: function (data) {
                    // si acabo de completar
                }
            });

        });
    </script>
</body>
</html>