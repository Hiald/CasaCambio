
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <title>Casa de cambio | Registro</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="A fully featured admin theme which can be used to build CRM, CMS, etc." name="description" />
    <meta content="Crivant" name="author" />
    <!-- App favicon -->
    @*<link rel="shortcut icon" href="assets/images/favicon.ico">*@

    <!-- App css -->
    <link href="~/assets/css/vendor/jquery-jvectormap-1.2.2.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/css/app.min.css" rel="stylesheet" type="text/css" id="light-style" />
    <link href="~/assets/css/app-dark.min.css" rel="stylesheet" type="text/css" id="dark-style" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/css-loader/3.3.3/css-loader.css" rel="stylesheet" />

    <script>
         var RutaPrincipal = "@Url.Content("~")";
    </script>
</head>

<body class="authentication-bg pb-0" data-layout-config='{"darkMode":false}'>
    <div id="divcarga" class="loader loader-default" data-text="Cargando... por favor espere" blink></div>

    <div class="account-pages mb-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header pt-2 pb-2 text-center bg-success">
                            <a href="index.html">
                                @*<span><img src="assets/images/logo.png" alt="" height="18"></span>*@
                            </a>
                        </div>

                        <div class="card-body p-3">
                            <div class="text-center w-75 m-auto">
                                <h4 class="text-dark-50 text-center mt-0 font-weight-bold">Regístrate</h4>
                                <p class="text-muted m2-4">Crea tu cuenta para poder continuar cambiando y ahorrando</p>
                            </div>

                            <form action="#" id="frm1">
                                <h6 class="font-15 mt-3">¿Qué tipo de cuenta deseas crear?</h6>
                                <div class="mt-2">
                                    <div class="custom-control custom-radio custom-control-inline">
                                        <input type="radio" id="customRadio3" checked value="1" name="rbt" class="custom-control-input">
                                        <label class="custom-control-label" for="customRadio3">Para uso personal</label>
                                    </div>
                                    <div class="custom-control custom-radio custom-control-inline">
                                        <input type="radio" id="customRadio4" value="2" name="rbt" class="custom-control-input">
                                        <label class="custom-control-label" for="customRadio4">Para empresas</label>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="txnombre">Nombres</label>
                                            <input class="form-control" maxlength="40" type="text" id="txnombre" placeholder="Ingresa tus nombres">
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="txapellido">Apellidos</label>
                                            <input class="form-control" maxlength="40" type="text" id="txapellido" placeholder="Ingresa tus apellidos">
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="slctipodocumento">Tipo de documento</label>
                                        <select class="custom-select mb-3" id="slctipodocumento">
                                            <option value="1">DNI</option>
                                            <option value="2">Carnet de extranjería</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group" id="divpersona">
                                            <label for="txdocumento">Número del documento</label>
                                            <input class="form-control" maxlength="15" type="text" id="txdocumento" placeholder="Ingresa el número del documento">
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6 form-group" id="divempresa">
                                        <label for="txruc">RUC</label>
                                        <input class="form-control" maxlength="25" type="text" id="txruc" placeholder="Ingresa el número de RUC">
                                    </div>
                                    <div class="col-md-6 form-group" id="divempresa2">
                                        <label for="txrazonsocial">Razón Social</label>
                                        <input class="form-control" maxlength="300" type="text" id="txrazonsocial" placeholder="Ingresa la razón social">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="txcorreo">Correo</label>
                                    <input class="form-control" maxlength="100" type="email" id="txcorreo" placeholder="Ingresa tu correo electrónico">
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="password">Contraseña</label>
                                            <div class="input-group input-group-merge">
                                                <input type="password" id="password" maxlength="20" class="form-control" placeholder="Ingresa tu contraseña">
                                                <div class="input-group-append" data-password="false">
                                                    <div class="input-group-text">
                                                        <span class="password-eye"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="passwordrep">Repite Contraseña</label>
                                            <div class="input-group input-group-merge">
                                                <input type="password" id="passwordrep" maxlength="20" class="form-control" placeholder="Repite tu contraseña">
                                                <div class="input-group-append" data-password="false">
                                                    <div class="input-group-text">
                                                        <span class="password-eye"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" class="custom-control-input" id="checkbox-signup">
                                        <label class="custom-control-label" for="checkbox-signup">Acepto los&nbsp;<a href="@Url.Action("terminosycondiciones","inicio")" class="text-muted" target="_blank">Términos y condiciones</a></label>
                                    </div>
                                </div>

                                <div class="form-group mb-0 text-center">
                                    <button class="btn btn-primary" id="btncrearcuenta"> Crear cuenta </button>
                                </div>

                            </form>
                        </div>

                    </div>
                    <!-- end card -->

                    <div class="row mt-3">
                        <div class="col-12 text-center">
                            <p class="text-success">¿Tienes cuenta? <a href="@Url.Action("registro","Inicio")" class="text-success ml-1"><b>Inicia sesión</b></a></p>
                        </div> <!-- end col-->
                    </div>
                    <!-- end row -->

                </div> <!-- end col -->
            </div>
            <!-- end row -->
        </div>
        <!-- end container -->
    </div>
    <!-- end page -->

    <script src="~/assets/js/vendor.min.js"></script>
    <script src="~/assets/js/app.min.js"></script>
    <script src="~/assets/js/moment.js"></script>

    <script>
        $('#frm1').submit(false);
        function NotificacionInfoDerecha(mensaje) {
            $.NotificationApp.send("Aviso!", mensaje, "top-right", "rgba(0,0,0,0.2)", "info")
        }

        function NotificacionAvisoIzquierda(mensaje) {
            $.NotificationApp.send("AVISO!", mensaje, "top-left", "rgba(0,0,0,0.2)", "warning")
        }

        function NotificacionAvisoIzquierdaAbajo(mensaje) {
            $.NotificationApp.send("AVISO!", mensaje, "bottom-left", "rgba(0,0,0,0.2)", "warning")
        }

        function NotificacionErrorIzquierda(mensaje) {
            $.NotificationApp.send("ERROR!", mensaje, "top-left", "rgba(0,0,0,0.2)", "error")
        }

        function NotificacionSuccessIzquierda(mensaje) {
            $.NotificationApp.send("DATOS CORRECTOS!", mensaje, "top-left", "rgba(0,0,0,0.2)", "success")
        }

        $('#divempresa').hide();
        $('#divempresa2').hide();
        $('input[type=radio][name=rbt]').change(function () {
            if (this.value == 1) {
                $('#divempresa').hide();
                $('#divempresa2').hide();
            }
            else if (this.value == 2) {
                $('#divempresa').show();
                $('#divempresa2').show();
            }
        });

        $('#btncrearcuenta').click(function () {
            $('#divcarga').addClass("is-active");
            var itipocuenta = $('input[name="rbt"]:checked').val();
            var snombre = $('#txnombre').val();
            var sapellido = $('#txapellido').val();
            var itipodocumento = $('#slctipodocumento option:selected').val();
            var sdocumento = $('#txdocumento').val();
            var sruc = $('#txruc').val();
            var srazonsocial = $('#txrazonsocial').val();
            var scorreo = $('#txcorreo').val();
            var sclave = $('#password').val();
            var repsclave = $('#passwordrep').val();
            var sfecharegistro = moment().format("YYYY-MM-DD");
            var shora = moment().format("hh:mm:ss");
            //1 personal, 2 empresa
            if (itipocuenta == 1) {
                if (snombre == "" || sapellido == "" || sdocumento == "" || scorreo == "") {
                    alert("Falta completar campos");
                    $('#divcarga').removeClass("is-active");
                    return;
                }
            } else {
                if (snombre == "" || sapellido == "" || sdocumento == "" || scorreo == "" || sruc == "" || srazonsocial == "") {
                    alert("Falta completar campos");
                    $('#divcarga').removeClass("is-active");
                    return;
                }
            }

            if (sclave.length <= 6) {
                alert("La contraseña debe ser mayor a 6 dígitos");
                $('#divcarga').removeClass("is-active");
                return;
            }

            if (sclave != repsclave) {
                alert("¡Ups! Las contraseñas no coinciden.");
                $('#divcarga').removeClass("is-active");
                return;
            }

            if ($("#checkbox-signup").prop('checked') == false) {
                alert("Por favor, acepta los términos y condiciones");
                return;
            }


            $.ajax({
                type: "POST",
                url: RutaPrincipal + 'Inicio/CrearUsuario',
                data: {
                    "wnombres": snombre,
                    "wapellidos": sapellido,
                    "wtipodocumento": itipodocumento,
                    "wdocumento": sdocumento,
                    "wfecharegistro": "",
                    "whoraregistro": "",
                    "wtipousuario": itipocuenta,
                    "wcorreo": scorreo,
                    "wclave": sclave,
                    "wtoken": "",
                    "wruc": sruc,
                    "wrazonsocial": srazonsocial
                },
                async: false,
                success: function (msg) {
                    if (msg.iResultado == -3) {
                        $('#divcarga').removeClass("is-active");
                        NotificacionErrorIzquierda("USUARIO O CLAVE INCORRECTO");
                        return;
                    } else {
                        window.location.href = RutaPrincipal + "Inicio/Principal";
                    }
                },
                error: function (msg) {

                    //location.reload();
                },
                complete: function (data) {
                    // si acabo de completar
                }
            });

        });
    </script>
</body>
</html>